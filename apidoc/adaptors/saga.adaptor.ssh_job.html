

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6. saga.adaptor.ssh_job &mdash; SAGA 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="top" title="SAGA 1.0 documentation" href="../index.html" />
    <link rel="up" title="5. Adaptors:" href="saga.adaptor.index.html" />
    <link rel="next" title="6. Developer Documentation" href="../developers/index.html" />
    <link rel="prev" title="5. saga.adaptor.filesystem.local" href="saga.adaptor.filesystem.local.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../developers/index.html" title="6. Developer Documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="saga.adaptor.filesystem.local.html" title="5. saga.adaptor.filesystem.local"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">SAGA 1.0 documentation</a> &raquo;</li>
          <li><a href="saga.adaptor.index.html" accesskey="U">5. Adaptors:</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="saga-adaptor-ssh-job">
<h1>6. saga.adaptor.ssh_job<a class="headerlink" href="#saga-adaptor-ssh-job" title="Permalink to this headline">¶</a></h1>
<p>A more elaborate description....
Known Limitations:
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;
* number of system pty&#8217;s are limited:  each job.service object bound
to this adaptor will use 2 pairs of pty pipes.  Systems usually
limit the number of available pty&#8217;s to 1024 .. 4096.  Given that
other process also use pty&#8217;s , that gives a hard limit to the number
of object instances which can be created concurrently.  Hitting the
pty limit will cause the following error message (or similar)::
NoSuccess: pty_allocation or process creation failed (ENOENT: no more ptys)
This limitation comes from saga.utils.pty_process.  On Linux
systems, the utilization of pty&#8217;s can be monitored::
echo &#8220;allocated pty&#8217;s: <cite>cat /proc/sys/kernel/pty/nr</cite>&#8221;
echo &#8220;available pty&#8217;s: <cite>cat /proc/sys/kernel/pty/max</cite>&#8221;
* number of ssh connections are limited: sshd&#8217;s default configuration,
which is in place on many systems, limits the number of concurrent
ssh connections to 10 per user &#8211; beyond that, connections are
refused with the following error::
NoSuccess: ssh_exchange_identification: Connection closed by remote host
As the communication with the ssh channel is unbuffered, the
dropping of the connection will likely cause this error message to
be lost.  Instead, the adaptor will just see that the ssh connection
disappeared, and will issue an error message similar to this one::
NoSuccess: read from pty process failed (Could not read line - pty process died)
* number of processes are limited: the creation of an job.service
object will create one additional process on the local system, and
two processes on the remote system (ssh daemon clone and a shell
instance).  Each remote job will create three additional processes:
two for the job instance itself (double fork), and an additional
process which monitors the job for state changes etc.  Additional
temporary processes may be needed as well.
While marked as &#8216;obsolete&#8217; by POSIX, the <cite>ulimit</cite> command is
available on many systems, and reports the number of processes
available per user (<cite>ulimit -u</cite>)
On hitting process limits, the job creation will fail with an error
similar to either of these::
NoSuccess: failed to run job (/bin/sh: fork: retry: Resource temporarily unavailable)
NoSuccess: failed to run job &#8211; backend error
* number of files are limited, as is disk space: the job.service will
keep job state on the remote disk, in <tt class="docutils literal"><span class="pre">$HOME/.saga/adaptors/ssh_job/</span></tt>.
Quota limitations may limit the number of files created there,
and/or the total size of that directory.
On quota or disk space limits, you may see error messages similar to
the following ones::
NoSuccess: read from pty process failed ([Errno 5] Quota exceeded)
NoSuccess: read from pty process failed ([Errno 5] Input/output error)
NoSuccess: find from pty process [Thread-5] failed (Could not read - pty process died)
* Other system limits (memory, CPU, selinux, accounting etc.) apply as
usual.
* thread safety: it is safe to create multiple <tt class="xref py py-class docutils literal"><span class="pre">job.Service</span></tt>
instances to the same target host at a time &#8211; they should not
interfere with each other, but <tt class="docutils literal"><span class="pre">list()</span></tt> will list jobs created by
either instance (if those use the same target host user account).
It is <strong>not</strong> safe to use the <em>same</em> <tt class="xref py py-class docutils literal"><span class="pre">job.Service</span></tt> instance
from multiple threads concurrently &#8211; the communication on the I/O
channel will likely get screwed up.  This limitation may be removed
in future versions of the adaptor.  Non-concurrent (i.e. serialized)
use should work as expected though.
* the adaptor option <tt class="docutils literal"><span class="pre">enable_debug_trace</span></tt> will create a detailed
trace of the remote shell execution, on the remote host.  This will
interfere with the shell&#8217;s stdio though, and may cause unexpected
failures.  Debugging should only be enabled as last resort, e.g.
when logging on DEBUG level remains inconclusive, and should
<strong>never</strong> be used in production mode.</p>
<div class="section" id="version">
<h2>6.1. Version<a class="headerlink" href="#version" title="Permalink to this headline">¶</a></h2>
<p>v0.1</p>
</div>
<div class="section" id="supported-schemas">
<h2>6.2. Supported Schemas<a class="headerlink" href="#supported-schemas" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><strong>fork</strong> : use /bin/sh to run jobs</li>
<li><strong>gsissh</strong> : use gsissh to run remote jobs</li>
<li><strong>ssh</strong> : use ssh to run remote jobs</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="configuration-options">
<h2>6.3. Configuration Options<a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">enabled</span></tt></p>
<p>enable / disable saga.adaptor.ssh_job adaptor</p>
<blockquote>
<div><ul class="simple">
<li><strong>type</strong> : &lt;type &#8216;bool&#8217;&gt;</li>
<li><strong>default</strong> : True</li>
<li><strong>environment</strong> : None</li>
<li><strong>valid options</strong> : [True, False]</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">enable_debug_trace</span></tt></p>
<p>Create a detailed debug trace on the remote host.
Note that the log is <em>not</em> removed, and can be large!
A log message on INFO level will be issued which
provides the location of the log file.</p>
<blockquote>
<div><ul class="simple">
<li><strong>type</strong> : &lt;type &#8216;bool&#8217;&gt;</li>
<li><strong>default</strong> : False</li>
<li><strong>environment</strong> : None</li>
<li><strong>valid options</strong> : [True, False]</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">enable_notifications</span></tt></p>
<p>Enable support for job state notifications.  Note that
enabling this option will create a local thread, a remote
shell process, and an additional network connection.
In particular for ssh/gsissh where the number of
concurrent connections is limited to 10, this
effectively halfs the number of available job service
instances per remote host.</p>
<blockquote>
<div><ul class="simple">
<li><strong>type</strong> : &lt;type &#8216;bool&#8217;&gt;</li>
<li><strong>default</strong> : False</li>
<li><strong>environment</strong> : None</li>
<li><strong>valid options</strong> : [True, False]</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="supported-capabilities">
<h2>6.4. Supported Capabilities<a class="headerlink" href="#supported-capabilities" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">Supported</span> <span class="pre">Monitorable</span> <span class="pre">Metrics</span></tt></p>
<blockquote>
<div><ul class="simple">
<li>State</li>
<li>StateDetail</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">Supported</span> <span class="pre">Job</span> <span class="pre">Attributes</span></tt></p>
<blockquote>
<div><ul class="simple">
<li>ExitCode</li>
<li>ExecutionHosts</li>
<li>Created</li>
<li>Started</li>
<li>Finished</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">Supported</span> <span class="pre">Context</span> <span class="pre">Types</span></tt></p>
<blockquote>
<div><ul class="simple">
<li><em>x509</em>: X509 proxy for gsissh</li>
<li><em>userpass</em>: username/password pair for simple ssh</li>
<li><em>ssh</em>: public/private keypair</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">Supported</span> <span class="pre">Job</span> <span class="pre">Description</span> <span class="pre">Attributes</span></tt></p>
<blockquote>
<div><ul class="simple">
<li>Executable</li>
<li>Arguments</li>
<li>Environment</li>
<li>Input</li>
<li>Output</li>
<li>Error</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="supported-api-classes">
<h2>6.5. Supported API Classes<a class="headerlink" href="#supported-api-classes" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="../library/job/index.html#saga.job.Service" title="saga.job.Service"><tt class="xref py py-class docutils literal"><span class="pre">saga.job.Service</span></tt></a></li>
<li><a class="reference internal" href="../library/job/index.html#saga.job.Job" title="saga.job.Job"><tt class="xref py py-class docutils literal"><span class="pre">saga.job.Job</span></tt></a></li>
</ul>
</div></blockquote>
<div class="section" id="saga-job-service">
<h3>6.5.1. saga.job.Service<a class="headerlink" href="#saga-job-service" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="saga.adaptors.ssh.ssh_job.SSHJobService">
<em class="property">class </em><tt class="descclassname">saga.adaptors.ssh.ssh_job.</tt><tt class="descname">SSHJobService</tt><big>(</big><em>api</em>, <em>adaptor</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJobService"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJobService" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">saga.adaptors.cpi.job.service.Service</span></tt></p>
<p>Implements saga.adaptors.cpi.job.Service</p>
<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJobService.init_instance">
<tt class="descname">init_instance</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJobService.init_instance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJobService.init_instance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJobService.initialize">
<tt class="descname">initialize</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJobService.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJobService.initialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJobService.finalize">
<tt class="descname">finalize</tt><big>(</big><em>kill_shell=False</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJobService.finalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJobService.finalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJobService.create_job">
<tt class="descname">create_job</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJobService.create_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJobService.create_job" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJobService.get_url">
<tt class="descname">get_url</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJobService.get_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJobService.get_url" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJobService.list">
<tt class="descname">list</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJobService.list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJobService.list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="saga-job-job">
<h3>6.5.2. saga.job.Job<a class="headerlink" href="#saga-job-job" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="saga.adaptors.ssh.ssh_job.SSHJob">
<em class="property">class </em><tt class="descclassname">saga.adaptors.ssh.ssh_job.</tt><tt class="descname">SSHJob</tt><big>(</big><em>api</em>, <em>adaptor</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJob" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">saga.adaptors.cpi.job.job.Job</span></tt></p>
<p>Implements saga.adaptors.cpi.job.Job</p>
<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJob.init_instance">
<tt class="descname">init_instance</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJob.init_instance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJob.init_instance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJob.get_state">
<tt class="descname">get_state</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJob.get_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJob.get_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJob.wait">
<tt class="descname">wait</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJob.wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJob.wait" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJob.get_id">
<tt class="descname">get_id</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJob.get_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJob.get_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJob.get_exit_code">
<tt class="descname">get_exit_code</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJob.get_exit_code"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJob.get_exit_code" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJob.cancel">
<tt class="descname">cancel</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJob.cancel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJob.cancel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJob.run">
<tt class="descname">run</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJob.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJob.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="saga.adaptors.ssh.ssh_job.SSHJob.re_raise">
<tt class="descname">re_raise</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/saga/adaptors/ssh/ssh_job.html#SSHJob.re_raise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#saga.adaptors.ssh.ssh_job.SSHJob.re_raise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">6. saga.adaptor.ssh_job</a><ul>
<li><a class="reference internal" href="#version">6.1. Version</a></li>
<li><a class="reference internal" href="#supported-schemas">6.2. Supported Schemas</a></li>
<li><a class="reference internal" href="#configuration-options">6.3. Configuration Options</a></li>
<li><a class="reference internal" href="#supported-capabilities">6.4. Supported Capabilities</a></li>
<li><a class="reference internal" href="#supported-api-classes">6.5. Supported API Classes</a><ul>
<li><a class="reference internal" href="#saga-job-service">6.5.1. saga.job.Service</a></li>
<li><a class="reference internal" href="#saga-job-job">6.5.2. saga.job.Job</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="saga.adaptor.filesystem.local.html"
                        title="previous chapter">5. saga.adaptor.filesystem.local</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../developers/index.html"
                        title="next chapter">6. Developer Documentation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/adaptors/saga.adaptor.ssh_job.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../developers/index.html" title="6. Developer Documentation"
             >next</a> |</li>
        <li class="right" >
          <a href="saga.adaptor.filesystem.local.html" title="5. saga.adaptor.filesystem.local"
             >previous</a> |</li>
        <li><a href="../index.html">SAGA 1.0 documentation</a> &raquo;</li>
          <li><a href="saga.adaptor.index.html" >5. Adaptors:</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, The SAGA Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>